---
output: html_document
editor_options: 
  chunk_output_type: console
---
# Download package "quantmod" for get daily stock price
# Download package "xlsx" for Read and Write xlsx file
```{r}
#install.packages("quantmod")
#install.packages("xlsx")
```
#remove all variable
```{r}
rm(list=ls(all=TRUE))
```

# import library "quantmod" for use in project
```{r}
library(quantmod)
library("xlsx")
```

############## init ##############
```{r}
symbol <- "cvx"
start_date <- "2013-07-20"
end_date <- "2016-09-18"

#Create File name

fileName <- paste(symbol, "Daily-Result", sep="-")
print(fileName)
```
--------------- init ---------------


############## Create Predict DataFrame ##############
#Set predict date (x = predict_date) ***
```{r}
x = (c('2013-07-20',
'2013-10-06',
'2013-10-07',
'2013-10-17',
'2013-10-19',
'2013-10-22',
'2013-10-23',
'2013-11-05',
'2013-11-08',
'2013-11-13',
'2013-11-27',
'2013-12-08',
'2013-12-09',
'2013-12-12',
'2014-01-23',
'2014-02-05',
'2014-02-25',
'2014-03-02',
'2014-03-05',
'2014-03-19',
'2014-04-09',
'2014-04-14',
'2014-04-23',
'2014-05-06',
'2014-05-19',
'2014-06-03',
'2014-06-18',
'2014-06-26',
'2014-07-07',
'2014-07-08',
'2014-07-11',
'2014-07-16',
'2014-07-17',
'2014-08-01',
'2014-08-02',
'2014-08-05',
'2014-08-07',
'2014-08-08',
'2014-08-09',
'2014-08-12',
'2014-08-13',
'2014-08-15',
'2014-08-26',
'2014-09-06',
'2014-09-09',
'2014-09-12',
'2014-09-15',
'2014-09-16',
'2014-09-17',
'2014-09-18',
'2014-09-19',
'2014-09-30',
'2014-10-06',
'2014-10-13',
'2014-10-14',
'2014-10-17',
'2014-10-21',
'2014-10-31',
'2014-11-01',
'2014-11-03',
'2014-11-04',
'2014-11-06',
'2014-11-10',
'2014-11-12',
'2014-11-15',
'2014-11-19',
'2014-11-20',
'2014-11-29',
'2014-12-02',
'2014-12-03',
'2014-12-04',
'2014-12-15',
'2014-12-16',
'2014-12-18',
'2014-12-19',
'2014-12-23',
'2014-12-24',
'2014-12-30',
'2014-12-31',
'2015-01-08',
'2015-01-09',
'2015-01-13',
'2015-01-21',
'2015-01-23',
'2015-01-30',
'2015-01-31',
'2015-02-03',
'2015-02-06',
'2015-02-13',
'2015-02-19',
'2015-02-21',
'2015-02-23',
'2015-02-24',
'2015-02-25',
'2015-02-28',
'2015-03-11',
'2015-03-14',
'2015-03-18',
'2015-03-27',
'2015-03-28',
'2015-03-30',
'2015-03-31',
'2015-04-08',
'2015-04-10',
'2015-04-13',
'2015-04-14',
'2015-04-15',
'2015-04-17',
'2015-04-18',
'2015-04-20',
'2015-04-21',
'2015-04-23',
'2015-04-24',
'2015-04-25',
'2015-05-01',
'2015-05-02',
'2015-05-04',
'2015-05-05',
'2015-05-07',
'2015-05-12',
'2015-05-13',
'2015-05-15',
'2015-05-16',
'2015-05-18',
'2015-05-27',
'2015-06-02',
'2015-06-03',
'2015-06-04',
'2015-06-05',
'2015-06-07',
'2015-06-10',
'2015-06-11',
'2015-06-12',
'2015-06-15',
'2015-06-16',
'2015-06-17',
'2015-06-18',
'2015-06-19',
'2015-06-24',
'2015-06-26',
'2015-06-27',
'2015-06-30',
'2015-07-03',
'2015-07-07',
'2015-07-08',
'2015-07-10',
'2015-07-14',
'2015-07-15',
'2015-07-20',
'2015-07-22',
'2015-07-23',
'2015-07-24',
'2015-07-27',
'2015-07-28',
'2015-07-29',
'2015-07-31',
'2015-08-01',
'2015-08-03',
'2015-08-04',
'2015-08-05',
'2015-08-06',
'2015-08-07',
'2015-08-08',
'2015-08-11',
'2015-08-12',
'2015-08-18',
'2015-08-19',
'2015-08-20',
'2015-08-21',
'2015-08-22',
'2015-08-24',
'2015-08-25',
'2015-08-26',
'2015-08-30',
'2015-08-31',
'2015-09-01',
'2015-09-02',
'2015-09-05',
'2015-09-08',
'2015-09-09',
'2015-09-10',
'2015-09-11',
'2015-09-12',
'2015-09-14',
'2015-09-15',
'2015-09-16',
'2015-09-17',
'2015-09-18',
'2015-09-22',
'2015-09-23',
'2015-09-25',
'2015-09-28',
'2015-09-29',
'2015-09-30',
'2015-10-01',
'2015-10-02',
'2015-10-03',
'2015-10-05',
'2015-10-06',
'2015-10-07',
'2015-10-08',
'2015-10-09',
'2015-10-10',
'2015-10-17',
'2015-10-18',
'2015-10-19',
'2015-10-20',
'2015-10-21',
'2015-10-22',
'2015-10-23',
'2015-10-24',
'2015-10-31',
'2015-11-02',
'2015-11-03',
'2015-11-04',
'2015-11-10',
'2015-11-11',
'2015-11-12',
'2015-11-13',
'2015-11-14',
'2015-11-21',
'2015-11-22',
'2015-11-23',
'2015-11-24',
'2015-11-25',
'2015-11-26',
'2015-11-27',
'2015-11-28',
'2015-11-30',
'2015-12-01',
'2015-12-02',
'2015-12-09',
'2015-12-10',
'2015-12-11',
'2015-12-17',
'2015-12-18',
'2015-12-20',
'2015-12-21',
'2015-12-22',
'2015-12-23',
'2015-12-24',
'2015-12-31',
'2016-01-01',
'2016-01-03',
'2016-01-04',
'2016-01-05',
'2016-01-12',
'2016-01-13',
'2016-01-14',
'2016-01-15',
'2016-01-22',
'2016-01-23',
'2016-01-24',
'2016-01-25',
'2016-01-26',
'2016-01-27',
'2016-02-03',
'2016-02-04',
'2016-02-05',
'2016-02-06',
'2016-02-13',
'2016-02-14',
'2016-02-15',
'2016-02-16',
'2016-02-17',
'2016-02-18',
'2016-02-19',
'2016-02-20',
'2016-02-26',
'2016-02-27',
'2016-02-29',
'2016-03-01',
'2016-03-02',
'2016-03-03',
'2016-03-04',
'2016-03-05',
'2016-03-11',
'2016-03-12',
'2016-03-13',
'2016-03-14',
'2016-03-15',
'2016-03-16',
'2016-03-23',
'2016-03-24',
'2016-03-25',
'2016-03-26',
'2016-03-27',
'2016-03-28',
'2016-03-29',
'2016-03-30',
'2016-03-31',
'2016-04-07',
'2016-04-08',
'2016-04-09',
'2016-04-10',
'2016-04-11',
'2016-04-18',
'2016-04-19',
'2016-04-20',
'2016-04-21',
'2016-04-22',
'2016-04-23',
'2016-04-29',
'2016-04-30',
'2016-05-01',
'2016-05-02',
'2016-05-03',
'2016-05-09',
'2016-05-10',
'2016-05-11',
'2016-05-18',
'2016-05-19',
'2016-05-20',
'2016-05-21',
'2016-05-29',
'2016-05-30',
'2016-05-31',
'2016-06-01',
'2016-06-02',
'2016-06-03',
'2016-06-04',
'2016-06-10',
'2016-06-11',
'2016-06-12',
'2016-06-13',
'2016-06-14',
'2016-06-15',
'2016-06-16',
'2016-06-22',
'2016-06-23',
'2016-06-24',
'2016-06-25',
'2016-06-27',
'2016-06-28',
'2016-06-29',
'2016-07-06',
'2016-07-07',
'2016-07-08',
'2016-07-14',
'2016-07-15',
'2016-07-16',
'2016-07-17',
'2016-07-18',
'2016-07-19',
'2016-07-20',
'2016-07-21',
'2016-07-22',
'2016-07-23',
'2016-07-24',
'2016-07-30',
'2016-07-31',
'2016-08-01',
'2016-08-02',
'2016-08-03',
'2016-08-09',
'2016-08-10',
'2016-08-11',
'2016-08-12',
'2016-08-19',
'2016-08-20',
'2016-08-22',
'2016-08-23',
'2016-08-31',
'2016-09-01',
'2016-09-02',
'2016-09-03',
'2016-09-05',
'2016-09-06',
'2016-09-14',
'2016-09-15',
'2016-09-16',
'2016-09-17',
'2016-09-18'))
```

#Set predict value (xx = predict_value) ***
```{r}
xx = (c('moving down',
'moving down',
'moving down',
'moving down',
'moving down',
'moving down',
'moving down',
'moving up',
'moving down',
'moving down',
'moving down',
'moving up',
'moving up',
'moving up',
'moving down',
'moving down',
'moving up',
'moving down',
'moving up',
'moving down',
'moving up',
'moving down',
'moving up',
'moving up',
'moving up',
'moving up',
'moving down',
'moving up',
'moving up',
'moving down',
'unchanged',
'moving up',
'moving down',
'moving down',
'moving down',
'moving up',
'moving down',
'moving down',
'moving down',
'moving down',
'moving down',
'moving down',
'moving up',
'moving down',
'moving down',
'moving up',
'moving up',
'moving down',
'moving down',
'unchanged',
'unchanged',
'moving up',
'moving down',
'moving down',
'moving up',
'moving up',
'moving up',
'moving down',
'moving down',
'moving up',
'moving up',
'moving down',
'moving down',
'moving up',
'moving up',
'moving up',
'moving down',
'moving down',
'moving down',
'moving down',
'moving down',
'unchanged',
'moving up',
'moving up',
'unchanged',
'moving up',
'moving up',
'moving down',
'moving up',
'moving down',
'unchanged',
'moving down',
'moving down',
'moving down',
'unchanged',
'moving down',
'unchanged',
'moving up',
'moving up',
'moving down',
'moving down',
'moving down',
'moving down',
'moving up',
'moving up',
'moving down',
'moving down',
'moving down',
'moving down',
'moving up',
'moving down',
'unchanged',
'moving down',
'moving down',
'unchanged',
'moving down',
'unchanged',
'moving up',
'moving down',
'moving up',
'moving down',
'moving down',
'unchanged',
'moving down',
'unchanged',
'moving down',
'moving up',
'moving down',
'moving down',
'unchanged',
'moving down',
'moving down',
'moving down',
'moving down',
'moving up',
'unchanged',
'moving up',
'moving up',
'unchanged',
'moving down',
'moving down',
'moving down',
'moving down',
'moving down',
'moving down',
'moving down',
'moving up',
'moving up',
'moving down',
'moving down',
'moving down',
'moving up',
'moving up',
'moving down',
'moving up',
'moving up',
'moving down',
'moving up',
'moving down',
'moving down',
'moving down',
'moving up',
'moving up',
'moving down',
'moving down',
'moving up',
'moving down',
'moving up',
'unchanged',
'moving up',
'moving down',
'moving up',
'moving down',
'moving up',
'unchanged',
'unchanged',
'moving down',
'moving up',
'moving down',
'moving down',
'moving down',
'moving down',
'unchanged',
'moving down',
'moving down',
'moving up',
'unchanged',
'unchanged',
'moving up',
'unchanged',
'moving up',
'moving down',
'moving up',
'moving up',
'moving down',
'moving down',
'unchanged',
'moving down',
'moving up',
'moving down',
'moving down',
'unchanged',
'moving up',
'moving down',
'moving up',
'moving down',
'moving down',
'moving up',
'moving up',
'moving up',
'moving up',
'moving down',
'unchanged',
'moving down',
'moving down',
'moving down',
'moving down',
'moving down',
'moving up',
'unchanged',
'moving up',
'moving down',
'moving down',
'moving down',
'moving down',
'moving up',
'unchanged',
'moving down',
'moving down',
'unchanged',
'moving up',
'unchanged',
'unchanged',
'moving down',
'unchanged',
'moving up',
'moving up',
'moving down',
'moving down',
'moving down',
'moving down',
'moving down',
'moving down',
'unchanged',
'moving down',
'moving down',
'moving down',
'unchanged',
'unchanged',
'moving down',
'unchanged',
'moving up',
'unchanged',
'moving down',
'unchanged',
'moving up',
'moving down',
'unchanged',
'moving down',
'moving up',
'moving up',
'moving up',
'moving up',
'moving up',
'moving down',
'moving up',
'moving down',
'unchanged',
'moving up',
'moving down',
'moving up',
'moving up',
'moving up',
'moving up',
'moving down',
'unchanged',
'moving up',
'moving down',
'moving down',
'unchanged',
'moving up',
'moving up',
'moving down',
'unchanged',
'moving up',
'moving up',
'moving down',
'moving down',
'moving down',
'moving up',
'moving up',
'moving down',
'moving up',
'unchanged',
'moving down',
'moving up',
'moving up',
'moving down',
'moving down',
'unchanged',
'moving up',
'unchanged',
'moving down',
'moving down',
'moving up',
'unchanged',
'unchanged',
'moving down',
'moving down',
'moving down',
'moving down',
'unchanged',
'moving down',
'moving down',
'moving down',
'moving up',
'moving down',
'unchanged',
'moving down',
'unchanged',
'moving down',
'moving up',
'unchanged',
'moving down',
'moving down',
'moving up',
'moving down',
'moving up',
'moving down',
'moving down',
'moving down',
'moving down',
'moving up',
'moving down',
'moving down',
'moving down',
'moving down',
'moving down',
'unchanged',
'moving down',
'moving down',
'moving up',
'moving up',
'unchanged',
'unchanged',
'moving down',
'unchanged',
'unchanged',
'unchanged',
'moving up',
'moving down',
'moving down',
'moving up',
'moving up',
'moving down',
'moving up',
'unchanged',
'moving down',
'moving up',
'moving down',
'moving up',
'unchanged',
'moving down',
'moving up',
'moving up',
'unchanged',
'moving down',
'moving down',
'moving up',
'moving down',
'moving down',
'moving up',
'moving down',
'moving up',
'moving up',
'unchanged',
'moving down',
'moving down',
'moving up',
'moving down',
'moving up',
'moving down',
'moving down'))
```

#Create predict Data Frame (x,xx)
```{r}
predictDataFrame = data.frame(day=x, predic=xx)
```
--------------- Create Predict DataFrame ---------------


############## Get Stock Price ##############
#Get stock price ***
```{r}
getSymbols(symbol, from = start_date, to = end_date, periodicity = "daily")
rm(start_date, end_date)
```

#Get only Close Price ***
```{r}
ClosePrice <- Cl(`CVX`) #Edit here
rm(CVX)
```

#Select only price will predict | y = date of Actual price
```{r}
y <- (c())
Actual_price <- ClosePrice[x]
y <- (index(Actual_price))
y <- as.factor(y) #convert dataType to factor

#rm(ClosePrice)
```
--------------- Get Stock Price ---------------


############## Manage Actual dataType and Create Actual DataFrame ##############
#Change Actual_price dataType to matrix.
```{r}
#Now DataType of "Actual_price" is 'xts'.
#We will change dataType to matrix.
#For we can get PriceValue in this valiable.

Actual_price_Matrix <- as.matrix(Actual_price)

#----------------------------------- 
#Loop for crate actual price list  -
#----------------------------------- 
ii <- 1
yy <-(c())
while (ii <= length(Actual_price_Matrix)) {
  yy <- append(yy, Actual_price_Matrix[ii])
  ii <- ii +1
}

actualDataFrame = data.frame(day=y, actualPrice=yy) #Create actualDataFrame

rm(Actual_price)
rm(Actual_price_Matrix)

```
--------------- Manage Actual dataType and Create Actual DataFrame ---------------


############## Merge predictDataFrame and actualDataFrame ##############
# Merge predicDataFrame and ClosePrice
```{r}
total = merge(predictDataFrame, actualDataFrame, by="day")
```
--------------- Merge predictDataFrame and actualDataFrame ---------------

############## Merge predictDataFrame and actualDataFrame ##############
```{r}

```

```{r}
#print(class(predictDataFrame[,1][1]))
#print(class(actualDataFrame[,1][1]))
#
#print(predictDataFrame[,1][1])
#print(actualDataFrame[,1][1])
```

#test
```{r}
#paste("Hello", "world", sep=" ")
#nn = "_Daily_Price_focus.xlsx"
#show1 = paste(symbol, nn, sep="")
#print(show1)

```


Creat excel file
```{r}
#write.xlsx(cvx_focus_price, file="CVX_Daily_Price_focus.xlsx", sheetName="Sheet1", col.names=TRUE, row.names=TRUE, append=FALSE)
```




